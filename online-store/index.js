(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var s=t.g.document;if(!e&&s&&(s.currentScript&&(e=s.currentScript.src),!e)){var n=s.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();const e="https://raw.githubusercontent.com/tretyakov-a/online-store/main";var s,n,r;!function(t){t.LOAD_APP="onProductsLoad",t.UPDATE_PRODUCTS_LIST="onProductsListUpdate",t.CHANGE_FILTERS="onFiltersChange",t.CHANGE_FILTER="onFilterChange",t.CHANGE_FILTER_APPEARANCE="onFilterAppearanceChange",t.UPDATE_FILTERS_PRODUCT_NUMBERS="onUpdateFilters",t.RESET_FILTER="onResetFilter",t.TRY_ADD_TO_CART="onTryAddToCart",t.TRY_DELETE_FROM_CART="onTryDeleteFromCart",t.ADD_TO_CART="onAddToCart",t.CHANGE_DISPLAY_OPTION="onChangeDisplayOption",t.CHANGE_SORT="onChangeSort",t.SHOW_ALERT="onShowAlert",t.RESET_FILTERS="onResetFilters",t.RESET_SETTINGS="onResetSettings",t.TOGGLE_MAIN_LEFT="onShowMainLeft",t.CHANGE_PAGE="onChangePage"}(s||(s={})),function(t){t.PRICE="price",t.WEIGHT="weight",t.BRAND="brand",t.COLOR="color",t.MOBILE_CONTROL="mobileControl",t.CAMERA_INCLUDED="cameraIncluded",t.SEARCH="search",t.YEAR="year",t.SIZE="size"}(n||(n={})),function(t){t.LIST="list",t.GRID="grid"}(r||(r={}));const i=r.GRID,a={"#00ba71":"зеленый","#00c2de":"синий",white:"белый",black:"черный","#fad717":"желтый",violet:"фиолетовый","#f43545":"красный","#ff8901":"оранжевый",gray:"серый"};var o;!function(t){t.PRICE="price",t.RATING="rating",t.YEAR="year",t.BRAND="brand",t.COLOR="color",t.WEIGHT="weight",t.MOBILE_CONTROL="mobileControl",t.CAMERA_INCLUDED="cameraIncluded",t.TITLE="title",t.SIZE="size"}(o||(o={}));const c={[o.PRICE]:t=>t.price,[o.RATING]:t=>t.rating,[o.YEAR]:t=>t.year,[o.BRAND]:t=>t.brand,[o.COLOR]:t=>t.props.classification?.specs.color?.value,[o.WEIGHT]:t=>Number.parseFloat(t.props.dimensions?.specs.weight?.value||""),[o.MOBILE_CONTROL]:t=>t.props.mobileSupport?.specs.mobileControl?.value,[o.CAMERA_INCLUDED]:t=>t.props.camera?.specs.cameraIncluded?.value,[o.TITLE]:t=>t.title,[o.SIZE]:t=>t.props.classification?.specs.size?.value};var d;!function(t){t.TITLE_ASC="titleAsc",t.TITLE_DESC="titleDesc",t.PRICE_ASC="priceAsc",t.PRICE_DESC="priceDesc",t.RATING_ASC="ratingAsc",t.RATING_DESC="ratingDesc"}(d||(d={}));const l=t=>"asc"===t?1:-1,h=t=>"asc"===t?-1:1,u=t=>e=>s=>{s.sort(((s,n)=>{const r=t(s),i=t(n);if(void 0!==r&&void 0!==i){if(r>i)return l(e);if(r<i)return h(e)}else void 0!==r&&void 0===i&&l(e),null==r&&void 0!==i&&h(e);return 0}))},p=u(c[o.TITLE]),_=u(c[o.PRICE]),g=u(c[o.RATING]),m={[d.TITLE_ASC]:["По имени (А-Я)",p("asc")],[d.TITLE_DESC]:["По имени (Я-А)",p("desc")],[d.PRICE_ASC]:["По возрастанию цены",_("asc")],[d.PRICE_DESC]:["По убыванию цены",_("desc")],[d.RATING_ASC]:["По возрастанию рейтинга",g("asc")],[d.RATING_DESC]:["По убыванию рейтинга",g("desc")]},v=t=>{if(!(t&&t instanceof HTMLElement))throw new TypeError;return t},f=t=>e=>v(t.querySelector(e)),C=t=>new Promise(((e,s)=>{if(!t)return s(new Error("Image src is undefined"));const n=new Image;n.src=t,n.addEventListener("error",s),n.addEventListener("load",(()=>e(t)))}));function E(t,e){let s=-1;return n=>{clearTimeout(s),s=window.setTimeout((()=>{e.call(this,n)}),t)}}function R(t,e){return Object.keys(t).reduce(((s,n)=>{const r=e.find((t=>t.id===n))?.price||0;return s+t[n]*r}),0)}class T{async load(){const t=await fetch(`${e}/data-21.json`);if(!t.ok)throw new Error("Data load error!");return await t.json()}}class L{constructor(t){const{root:e,component:s}=t;this.component=s,this.root=e||null,this._root=null}getRoot(){return null===this._root?"string"!=typeof this.root?v(this.root):f(document)(this.root):this._root}afterRender(t,e=-1){if("string"==typeof this.root){if(-1===e&&null!==t)this._root=f(t.getRoot())(this.root);else if(null!==t){const s=t.getRoot().querySelectorAll(this.root)[e];s instanceof HTMLElement&&(this._root=s)}}else this._root=this.root}renderChild(...t){return this.component.renderChild(...t)}render(t){return void 0!==t&&"string"==typeof t?t:""}}class I extends L{constructor(t){super({...t,root:".lds-ellipsis"})}render(){return super.render('\n      <div class="lds-ellipsis">\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n      </div>\n    ')}}class A extends L{constructor(t){super(t),this.isLoading=!1}render(t){const e=this.isLoading?this.renderChild("spinner",y,{viewConstructor:I}):"string"==typeof t?t:"";return"function"==typeof t?t(e):e}}function S(t,{data:e,forceLog:s=!1}={}){s&&console.log(`%c${t}`,"color: blue;",Object.getPrototypeOf(this).constructor.name,this.viewConstructor?.name,e||"")}class y extends class{constructor(t){this.emmiter=t,this.listenersForRemove=[]}emit(t,e){this.emmiter?.emit(t,e)}on(t,e){this.emmiter&&this.listenersForRemove.push(this.emmiter.on(t,e))}}{constructor(t){if(super(t.emmiter),this.name=t.name||"",this.id=-1,this.parent=t.parent||null,this._components={},this.handlers=t.handlers||{},this.viewConstructor=t.viewConstructor||L,this.viewConstructor.name===L.prototype.constructor.name&&void 0===t.viewOptions?.root)throw new Error(`You should specify root for component (${this.constructor.name}) with no view`);this.view=new this.viewConstructor({...t.viewOptions,component:this}),S.call(this,"COMPONENT CONSTRUCTING END")}renderChild(...[t,e,s={}]){S.call(this,"COMPONENT ADD CHILD:",{data:`'${t}'[${e.name}]`});const n=new e({...s,name:t,parent:this,emmiter:this.emmiter}),r=this._components[t];return void 0!==r?Array.isArray(r)?(n.id=r.length,r.push(n)):(r.id=0,n.id=1,this._components[t]=[r,n]):this._components[t]=n,n.render(s.viewOptions?.data)}isArrayItem(){return-1!==this.id}remove(){this.parent?.removeChild(this)}update(t){this.parent?.updateChild(this,t)}removeChild(t){t.onDestroy();const e=this._components[t.name];if(Array.isArray(e)){const s=e.filter((e=>e.getId()!==t.getId()));s.forEach(((t,e)=>t.setId(e))),1===s.length&&(this._components[t.name]=s[0])}else delete this._components[t.name];const s=t.getRoot();s.parentNode?.removeChild(s)}updateChild(t,e){S.call(this,"UPDATING",{data:`CHILD: ${t.name}`});const s=t.getRoot(),n=t.render(e);if(t.view.constructor.name===L.prototype.constructor.name){const t=s.cloneNode();t.innerHTML=n,s.after(t)}else s.insertAdjacentHTML("afterend",n);s.parentNode?.removeChild(s),t.afterRender()}getChild(t){return this._components[t]}getId(){return this.id}setId(t){this.id=t}getComponent(t){return this._components[t]}getComponents(){return this._components}getRoot(){return this.view.getRoot()}onLoadingStart(){this.view instanceof A&&(this.view.isLoading=!0)}onLoadingEnd(t){this.view instanceof A&&(this.view.isLoading=!1),this.update(t)}render(t){return S.call(this,"COMPONENT RENDER: "),Object.keys(this._components).length>0&&this.removeChildrens(),this.view.render(t)}afterRender(){S.call(this,"COMPONENT AFTER RENDER",{data:this.parent?.getRoot()}),this.view.afterRender(this.parent,this.id),Object.keys(this._components).forEach((t=>{const e=this._components[t];Array.isArray(e)?e.forEach((t=>t.afterRender())):e.afterRender()}))}removeChildrens(){Object.keys(this._components).forEach((t=>{const e=this._components[t];Array.isArray(e)?e.forEach((t=>t.onDestroy())):e.onDestroy()})),this._components={}}onDestroy(){this.listenersForRemove.forEach((t=>t.call(null))),this.removeChildrens()}}class w{constructor(t){this.key=t}async save(t){window.localStorage.setItem(this.key,JSON.stringify(t))}async load(){const t=window.localStorage.getItem(this.key);return null===t?null:JSON.parse(t)}}class $ extends y{constructor(t){super(t),this.saveState=async()=>{this.storageService.save(this.state)},this.storageService=new w("appState"),this.state=this.getDefaultState(),window.addEventListener("beforeunload",this.saveState)}async loadState(){return await this.storageService.load()}getDefaultState(){return JSON.parse(JSON.stringify($.defaultState))}}$.defaultState={productInCartIds:{},sort:d.TITLE_ASC,filterStates:{},appearance:{filters:{},displayOption:i}};class b extends L{constructor(t){super({...t,root:".rsschool-logo"})}render(){return super.render('\n      <a class="rsschool-logo" href="https://rs.school/js/" title="https://rs.school/js/" target="_blank">\n        <svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 552.8 205.3">\n          <style>.st0{fill:var( --text-color-1)}.st1{clip-path:url(#SVGID_2_)}.st2{clip-path:url(#SVGID_4_)}.st3{clip-path:url(#SVGID_6_)}.st4{clip-path:url(#SVGID_8_)}.st5{fill:var(--text-color-1);stroke-width:4;stroke-miterlimit:10}.st6{clip-path:url(#SVGID_8_)}.st6,.st7{fill:none;stroke-width:4;stroke-miterlimit:10}.st8,.st9{clip-path:url(#SVGID_10_)}.st9{fill:none;stroke-width:4;stroke-miterlimit:10}</style>\n          <title>rs_school_js</title>\n          <path class="logo-path" d="M285.4 68l26.3-1.7c.6 4.3 1.7 7.5 3.5 9.8 2.9 3.6 6.9 5.4 12.2 5.4 3.9 0 7-.9 9.1-2.8 2-1.5 3.2-3.9 3.2-6.4 0-2.4-1.1-4.7-3-6.2-2-1.8-6.7-3.6-14.1-5.2-12.1-2.7-20.8-6.3-25.9-10.9-5.1-4.3-8-10.6-7.8-17.3 0-4.6 1.4-9.2 4-13 3-4.3 7.1-7.7 12-9.6 5.3-2.3 12.7-3.5 22-3.5 11.4 0 20.1 2.1 26.1 6.4 6 4.2 9.6 11 10.7 20.3l-26 1.5c-.7-4-2.1-6.9-4.4-8.8s-5.3-2.8-9.2-2.8c-3.2 0-5.6.7-7.2 2-1.5 1.2-2.5 3-2.4 5 0 1.5.8 2.9 2 3.8 1.3 1.2 4.4 2.3 9.3 3.3 12.1 2.6 20.7 5.2 26 7.9 5.3 2.7 9.1 6 11.4 9.9 2.4 4 3.6 8.6 3.5 13.3 0 5.6-1.6 11.2-4.8 15.9-3.3 4.9-7.9 8.7-13.3 11-5.7 2.5-12.9 3.8-21.5 3.8-15.2 0-25.7-2.9-31.6-8.8S286.1 77 285.4 68zM6.3 97.6V8.2h46.1c8.5 0 15.1.7 19.6 2.2 4.4 1.4 8.3 4.3 10.9 8.2 2.9 4.3 4.3 9.3 4.2 14.5.3 8.8-4.2 17.2-11.9 21.6-3 1.7-6.3 2.9-9.7 3.5 2.5.7 5 1.9 7.2 3.3 1.7 1.4 3.1 3 4.4 4.7 1.5 1.7 2.8 3.6 3.9 5.6l13.4 25.9H63L48.2 70.2c-1.9-3.5-3.5-5.8-5-6.9-2-1.4-4.4-2.1-6.8-2.1H34v36.3H6.3zM34 44.4h11.7c2.5-.2 4.9-.6 7.3-1.2 1.8-.3 3.4-1.3 4.5-2.8 2.7-3.6 2.3-8.7-1-11.8-1.8-1.5-5.3-2.3-10.3-2.3H34v18.1zM0 174.2l26.3-1.7c.6 4.3 1.7 7.5 3.5 9.8 2.8 3.6 6.9 5.5 12.2 5.5 3.9 0 7-.9 9.1-2.8 2-1.6 3.2-3.9 3.2-6.4 0-2.4-1.1-4.7-3-6.2-2-1.8-6.7-3.6-14.2-5.2-12.1-2.7-20.8-6.3-25.9-10.9-5.1-4.3-8-10.6-7.8-17.3 0-4.6 1.4-9.2 4-13 3-4.3 7.1-7.7 12-9.6 5.3-2.3 12.7-3.5 22-3.5 11.4 0 20.1 2.1 26.1 6.4s9.5 11 10.6 20.3l-26 1.5c-.7-4-2.1-6.9-4.4-8.8-2.2-1.9-5.3-2.8-9.2-2.7-3.2 0-5.6.7-7.2 2.1-1.6 1.2-2.5 3-2.4 5 0 1.5.8 2.9 2 3.8 1.3 1.2 4.4 2.3 9.3 3.3 12.1 2.6 20.7 5.2 26 7.9 5.3 2.7 9.1 6 11.4 9.9 2.4 4 3.6 8.6 3.6 13.2 0 5.6-1.7 11.1-4.8 15.8-3.3 4.9-7.9 8.7-13.3 11-5.7 2.5-12.9 3.8-21.5 3.8-15.2 0-25.7-2.9-31.6-8.8-5.9-6-9.2-13.4-10-22.4z"/>\n          <path class="logo-path" d="M133 167.2l24.2 7.3c-1.3 6.1-4 11.9-7.7 17-3.4 4.5-7.9 8-13 10.3-5.2 2.3-11.8 3.5-19.8 3.5-9.7 0-17.7-1.4-23.8-4.2-6.2-2.8-11.5-7.8-16-14.9-4.5-7.1-6.7-16.2-6.7-27.3 0-14.8 3.9-26.2 11.8-34.1s19-11.9 33.4-11.9c11.3 0 20.1 2.3 26.6 6.8 6.4 4.6 11.2 11.6 14.4 21l-24.4 5.4c-.6-2.1-1.5-4.2-2.7-6-1.5-2.1-3.4-3.7-5.7-4.9-2.3-1.2-4.9-1.7-7.5-1.7-6.3 0-11.1 2.5-14.4 7.6-2.5 3.7-3.8 9.6-3.8 17.6 0 9.9 1.5 16.7 4.5 20.4 3 3.7 7.2 5.5 12.7 5.5 5.3 0 9.3-1.5 12-4.4 2.7-3.1 4.7-7.4 5.9-13zm56.5-52.8h27.6v31.3h30.2v-31.3h27.8v89.4h-27.8v-36.2h-30.2v36.2h-27.6v-89.4z"/>\n          <path class="logo-path" d="M271.3 159.1c0-14.6 4.1-26 12.2-34.1 8.1-8.1 19.5-12.2 34-12.2 14.9 0 26.3 4 34.4 12S364 144 364 158.4c0 10.5-1.8 19-5.3 25.7-3.4 6.6-8.7 12-15.2 15.6-6.7 3.7-15 5.6-24.9 5.6-10.1 0-18.4-1.6-25-4.8-6.8-3.4-12.4-8.7-16.1-15.2-4.1-7-6.2-15.7-6.2-26.2zm27.6.1c0 9 1.7 15.5 5 19.5 3.3 3.9 7.9 5.9 13.7 5.9 5.9 0 10.5-1.9 13.8-5.8s4.9-10.8 4.9-20.8c0-8.4-1.7-14.6-5.1-18.4-3.4-3.9-8-5.8-13.8-5.8-5.1-.2-10 2-13.4 5.9-3.4 3.9-5.1 10.4-5.1 19.5zm93.4-.1c0-14.6 4.1-26 12.2-34.1 8.1-8.1 19.5-12.2 34-12.2 14.9 0 26.4 4 34.4 12S485 144 485 158.4c0 10.5-1.8 19-5.3 25.7-3.4 6.6-8.7 12-15.2 15.6-6.7 3.7-15 5.6-24.9 5.6-10.1 0-18.4-1.6-25-4.8-6.8-3.4-12.4-8.7-16.1-15.2-4.1-7-6.2-15.7-6.2-26.2zm27.6.1c0 9 1.7 15.5 5 19.5 3.3 3.9 7.9 5.9 13.7 5.9 5.9 0 10.5-1.9 13.8-5.8 3.3-3.9 4.9-10.8 4.9-20.8 0-8.4-1.7-14.6-5.1-18.4-3.4-3.9-8-5.8-13.8-5.8-5.1-.2-10.1 2-13.4 5.9-3.4 3.9-5.1 10.4-5.1 19.5z"/>\n          <path class="logo-path" d="M482.1 114.4h27.6v67.4h43.1v22H482v-89.4z"/>\n          <ellipse transform="rotate(-37.001 420.46 67.88)" class="st0" cx="420.5" cy="67.9" rx="63" ry="51.8"/><defs><ellipse id="SVGID_1_" class="st0" transform="rotate(-37.001 420.46 67.88)" cx="420.5" cy="67.9" rx="63" ry="51.8"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" overflow="visible"/></clipPath><g class="st1"><path transform="rotate(-37.001 420.82 68.353)" class="st0" d="M330.9-14.2h179.8v165.1H330.9z"/><g id="Layer_2_1_"><defs><path id="SVGID_3_" transform="rotate(-37.001 420.82 68.353)" d="M330.9-14.2h179.8v165.1H330.9z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" overflow="visible"/></clipPath><g id="Layer_1-2" class="st2"><ellipse transform="rotate(-37.001 420.46 67.88)" class="st0" cx="420.5" cy="67.9" rx="63" ry="51.8"/><defs><ellipse id="SVGID_5_" transform="rotate(-37.001 420.46 67.88)" cx="420.5" cy="67.9" rx="63" ry="51.8"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" overflow="visible"/></clipPath><g class="st3"><path transform="rotate(-37 420.799 68.802)" class="st0" d="M357.8 17h125.9v103.7H357.8z"/><defs><path id="SVGID_7_" transform="rotate(-37 420.799 68.802)" d="M357.8 17h125.9v103.7H357.8z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" overflow="visible"/></clipPath><g class="st4"><ellipse transform="rotate(-37.001 420.46 67.88)" class="st5" cx="420.5" cy="67.9" rx="63" ry="51.8"/></g><path transform="rotate(-37 420.799 68.802)" class="st6" d="M357.8 17h125.9v103.7H357.8z"/><ellipse transform="rotate(-37.001 420.46 67.88)" class="st7" cx="420.5" cy="67.9" rx="63" ry="51.8"/><path transform="rotate(-37 420.799 68.802)" class="st0" d="M357.8 17h125.9v103.7H357.8z"/><defs><path id="SVGID_9_" transform="rotate(-37 420.799 68.802)" d="M357.8 17h125.9v103.7H357.8z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" overflow="visible"/></clipPath><g class="st8"><ellipse transform="rotate(-37.001 420.46 67.88)" class="st5" cx="420.5" cy="67.9" rx="63" ry="51.8"/></g><path transform="rotate(-37 420.799 68.802)" class="st9" d="M357.8 17h125.9v103.7H357.8z"/><path transform="rotate(-37.001 420.82 68.353)" class="st7" d="M330.9-14.2h179.8v165.1H330.9z"/></g><ellipse transform="rotate(-37.001 420.46 67.88)" class="st7" cx="420.5" cy="67.9" rx="63" ry="51.8"/>\n          <path class="st1" d="M392.4 61.3l10-7 12.3 17.5c2.1 2.8 3.7 5.8 4.9 9.1.7 2.5.5 5.2-.5 7.6-1.3 3-3.4 5.5-6.2 7.3-3.3 2.3-6.1 3.6-8.5 4-2.3.4-4.7 0-6.9-1-2.4-1.2-4.5-2.9-6.1-5.1l8.6-8c.7 1.1 1.6 2.1 2.6 2.9.7.5 1.5.8 2.4.8.7 0 1.4-.3 1.9-.7 1-.6 1.7-1.8 1.6-3-.3-1.7-1-3.4-2.1-4.7l-14-19.7zm30 11.1l9.1-7.2c1 1.2 2.3 2.1 3.7 2.6 2 .6 4.1.2 5.8-1.1 1.2-.8 2.2-1.9 2.6-3.3.6-1.8-.4-3.8-2.2-4.4-.3-.1-.6-.2-.9-.2-1.2-.1-3.3.4-6.4 1.7-5.1 2.1-9.1 2.9-12.1 2.6-2.9-.3-5.6-1.8-7.2-4.3-1.2-1.7-1.8-3.7-1.9-5.7 0-2.3.6-4.6 1.9-6.5 1.9-2.7 4.2-5 7-6.8 4.2-2.9 7.9-4.3 11.1-4.3 3.2 0 6.2 1.5 9 4.6l-9 7.1c-1.8-2.3-5.2-2.8-7.5-1l-.3.3c-1 .6-1.7 1.5-2.1 2.6-.3.8-.1 1.7.4 2.4.4.5 1 .9 1.7.9.8.1 2.2-.3 4.2-1.2 5-2.1 8.8-3.3 11.4-3.7 2.2-.4 4.5-.2 6.6.7 1.9.8 3.5 2.2 4.6 3.9 1.4 2 2.2 4.4 2.3 6.9.1 2.6-.6 5.1-2 7.3-1.8 2.7-4.1 5-6.8 6.8-5.5 3.8-10 5.4-13.6 4.8-3.9-.6-7.1-2.6-9.4-5.5z"/></g></g></g>\n        </svg>\n      </a>\n    ')}}class x extends L{constructor(t){super({...t,root:".footer"})}render(){return super.render(`\n      <div class="footer">\n        <div class="footer__container container">\n          ${this.renderChild("rssLogo",y,{viewConstructor:b})}\n          <div class="footer__year">\n            2022\n          </div>\n          <a class="footer__github-link" href="https://github.com/tretyakov-a" title="GitHub" target="_blank">\n            <i class="fab fa-github"></i>\n            tretyakov-a\n          </a>\n        </div>\n      </div>\n    `)}}class k extends A{constructor(t){super({...t,root:".header__cart"})}renderCart(t){return`\n      <div class="cart">\n        <div class="cart__total">${t}</div>\n        <a class="button button_icon cart__link" href="#cart">\n          <i class="fa-solid fa-cart-plus"></i>\n        </a>\n      </div>`}render(t){let e="";return void 0!==t&&(e=this.renderCart(t.productsAmount)),super.render((t=>`\n      <div class="header__cart">\n        ${""!==t?t:e}\n      </div>\n    `))}}class O extends y{constructor(t){super({...t,viewConstructor:k}),this.handleAddToCart=t=>{const{productsAmount:e}=t.detail;this.update({productsAmount:e})},this.handleDataLoad=t=>{const{productInCartIds:e}=t.detail.state,s=Object.keys(e).reduce(((t,s)=>t+e[s]),0);this.onLoadingEnd({productsAmount:s})},this.on(s.ADD_TO_CART,this.handleAddToCart),this.on(s.LOAD_APP,this.handleDataLoad),this.onLoadingStart()}render(t){return super.render(t)}}var D;!function(t){t[t.FILTERS=0]="FILTERS",t[t.CROSS=1]="CROSS",t[t.CART=2]="CART"}(D||(D={}));const P={[D.FILTERS]:'<i class="fa-solid fa-sliders"></i>',[D.CROSS]:'<i class="fa-solid fa-xmark"></i>',[D.CART]:'<i class="fa-solid fa-cart-plus"></i>'};class N extends L{constructor(t){super({...t,root:".button__icon"})}render(t=D.CROSS){return super.render(`\n      <span class="button__icon">\n        ${"string"==typeof t?t:P[t]}\n      </span>\n    `)}}class F extends L{constructor(t){super({...t,root:".filters-btn"})}render(){return super.render(`\n      <div class="header__filters-btn filters-btn">\n        <button class="button button_icon">\n          ${this.renderChild("icon",y,{viewConstructor:N,viewOptions:{data:D.FILTERS}})}\n        </button>\n      </div>\n    `)}}class H extends y{constructor(){super(...arguments),this.onClick=t=>{this.handlers?.onClick(t)}}afterRender(){super.afterRender(),this.getRoot().querySelector("button")?.addEventListener("click",this.onClick)}getIcon(){const t=this.getComponent("icon");if(void 0!==t&&!Array.isArray(t))return t}}class M extends H{constructor(t){super({...t,viewConstructor:F}),this.onClick=t=>{t.stopPropagation(),this.toogle()},this.handleDocumentClick=t=>{const e=t.target;null!==e&&e instanceof HTMLElement&&null!==e.closest(".shop__left")||this.getRoot().classList.contains(M.showMod)&&this.toogle()},this.show=!1}toogle(){this.show=!this.show;const t=this.getIcon(),e=this.getRoot().parentElement;if(this.show){const{top:s,left:n,width:r}=this.getRoot().getBoundingClientRect();this.getRoot().classList.add(M.showMod),this.getRoot().style.top=`${s}px`,this.getRoot().style.left=`${n}px`,e&&(e.style.paddingLeft=`calc(${r}px + 1rem)`),document.body.classList.add("no-y-scroll"),t?.update(D.CROSS)}else this.getRoot().classList.remove(M.showMod),t?.update(D.FILTERS),e&&(e.style.paddingLeft="0px"),document.body.classList.remove("no-y-scroll");this.emit(s.TOGGLE_MAIN_LEFT,this.show)}afterRender(){super.afterRender(),document.addEventListener("click",this.handleDocumentClick)}}M.showMod="filters-btn_show";class G{static getPath(){return window.location.hash.split("?")[0]}static getQueryParams(){const[t,e]=window.location.hash.split("?");let s={};return void 0!==e&&""!==e&&(s=e.split("&").map((t=>t.split("="))).reduce(((t,[e,s])=>(t[e]=s,t)),{})),s}static change(t){const{origin:e,pathname:s}=window.location,n=new URL(`${e}${s}#${t}`);window.history.pushState({},"",n),window.dispatchEvent(new HashChangeEvent("hashchange"))}}class V extends L{constructor(t){super({...t,root:".header"})}render(){const t=G.getPath();return super.render(`\n      <div class="header">\n        <div class="header__container container">\n          <div class="header__left">\n            ${""===t?this.renderChild("filtersBurger",M):""}\n            <a class="header__logo logo" href="#">\n              <h1>QuadroShop</h1>\n            </a>\n          </div>\n          <nav class="header__menu">\n            ${this.renderChild("cartBtn",O)}\n          </nav>\n        </div>\n      </div>\n    `)}}class j extends L{constructor(t){super({...t,root:".alert"})}render(t){return super.render(`\n      <div class="alert">\n        <p>${t?t.message:""}</p>\n      </div>\n    `)}}class U extends y{constructor(t){super({...t,viewConstructor:j}),this.handleShowAlert=t=>{const e=t.detail;this.update({message:e}),this.getRoot().classList.remove("alert_hide"),this.getRoot().classList.add("alert_show"),setTimeout((()=>{this.getRoot().classList.remove("alert_show"),this.getRoot().classList.add("alert_hide")}),U.hideDelay)},this.on(s.SHOW_ALERT,this.handleShowAlert)}}U.hideDelay=3e3;const B=t.p+"a175591224426394096c.png";class z extends L{constructor(t){super({...t,root:".page-not-found"})}render(){return super.render(`\n      <div class="page-not-found">\n        <div class="page-not-found__container container">\n          <img class="page-not-found__img" src="${B}" alt="not found">\n          <p>404. Page not found!</p>\n          <a href="#">Back to main page</a>\n        </div>\n      </div>\n    `)}}class Y extends y{constructor(t){super(t),this.handlePageChange=()=>{const t=this.getRouteData();window.scrollTo({top:0}),this.update(t),this.emit(s.CHANGE_PAGE)},this.routes=t.data.routes,window.addEventListener("hashchange",this.handlePageChange)}getRouteData(){let t=G.getPath();return""===t&&(t+="#"),"#not-found"===t||void 0===this.routes[t]?["notFoundPage",y,{viewConstructor:z}]:this.routes[t]}render(t){super.render();let e=t;return void 0===e&&(e=this.getRouteData()),"string"==typeof e?e:this.renderChild(...e)}}class Z extends L{constructor(t){super({...t,root:".product__rating"})}getStarStyle(t){if(100===t)return"";const e=`${t}%`;return`style="background: linear-gradient(90deg, #ffa500 ${e}, #ffffff ${e});"`}renderStars(t){const e=Number.parseFloat(t);return Array(5).fill(0).map(((t,s)=>{if(s+1<=e)return 100;const n=Math.trunc(100*(1-(s+1-e)));return n<0?0:n})).map((t=>`\n        <span class="product-rating__star">\n          <span class="product-rating__start-inner" ${this.getStarStyle(t)}></span>\n        </span>\n      `)).join("")}render(t){return super.render(`\n      <div class="product__rating product-rating">\n        <span class="product-rating__stars">\n          ${this.renderStars(t.rating)}\n        </span>\n        <span class="product-rating__value">${t.rating}</span>\n      </div>\n    `)}}class W extends L{constructor(t){super({...t,root:".product__add-to-cart"})}render(t){const{isInCart:e}=t,s=e?"В корзине":"Купить",n=e?"Перейти в корзину":"Добавить в корзину";return super.render(`\n      <div class="product__add-to-cart">\n        <button class="button ${e?"button_in-cart":""}" title="${n}">\n          ${s}\n        </button>\n      </div>\n    `)}}class q extends H{constructor(t){if(!t.data)throw TypeError();super({...t,viewConstructor:W}),this.handleAddToCart=()=>{this.isInCart=!0,this.update({isInCart:this.isInCart})},this.onClick=()=>{const{productId:t,handleAddToCart:e}=this;if(this.isInCart)return G.change("cart");this.emit(s.TRY_ADD_TO_CART,{productId:t,inc:1,handleAddToCart:e})};const{data:e}=t;if(void 0===e)throw new TypeError;this.productId=t.data.product.id,this.isInCart=e.isInCart}}class J extends A{constructor(t){super({...t,root:".product-details"})}renderPropSpecs(t){return`\n      <ul class="props__specs specs">\n        ${Object.keys(t).map((e=>{const{title:s,value:n}=t[e]||{};return`\n        <li class="specs__item">\n          <span class="specs__title">${s}</span>\n          <span class="specs__value">${n}</span>\n        </li>`})).join("")}\n      </ul>`}renderProps({props:t}){return`\n      <ul class="props">\n        ${Object.keys(t).map((e=>{const{title:s,specs:n={}}=t[e]||{};return`\n        <li class="props__item">\n          <h4 class="props__title">${s}</h4>\n          ${this.renderPropSpecs(n)}\n        </li>`})).join("")}\n      </ul>`}renderProduct(t){const{product:s,state:{productInCartIds:n}}=t,{id:r,title:i,description:a,imgs:o,price:c,rating:d,brand:l,brandImage:h}=s,u=Object.keys(n).includes(r),{model:p,type:_}=s.props.classification?.specs||{},g=`${e}/${o[0]}`;return C(g).then((t=>{const e=f(this.getRoot())(".product-details-slider img");e instanceof HTMLImageElement&&(e.src=t)})),`\n      <h2 class="product-details__title page-title">${m=_?.value||"",m[0].toUpperCase()+m.slice(1)} ${p?.value}</h2>\n      <section class="section product-details__card">\n        <div class="product-details__left">\n          <div class="product-details-slider">\n            <img\n              src="${B}"\n              alt="${i}">\n          </div>\n        </div>\n        <div class="product-details__right">\n          <div class="product-details__info">\n            <div class="product-details__info-row">\n              <div class="product-details__info-title">${i}</div>\n              <div class="product-details__info-brand">\n                <img src="${e}/${h}" alt="${l}">\n              </div>\n            </div>\n            <div class="product-details__info-row">\n              ${this.renderChild("productRating",y,{viewConstructor:Z,viewOptions:{data:{rating:d}}})}\n            </div>\n            <div class="product-details__info-row">\n              <div class="product-details__price">${c} ₽</div>\n              ${this.renderChild("addToCart",q,{data:{product:s,isInCart:u},viewOptions:{data:{isInCart:u}}})}\n            </div>\n            <div class="product-details__info-row">\n              <section class="section product-details__description" id="description">\n                <h3 class="section__header">Описание</h3>\n                <p class="section__content">\n                  ${a}\n                </p>\n              </section>\n            </div>\n          </div>\n        </div>\n      </section>\n      <section class="section product-details__characteristics" id="characteristics">\n        <h3 class="section__header">Характеристики</h3>\n        <p class="section__content">\n          ${this.renderProps(s)}\n        </p>\n      </section>`;var m}render(t){let e="";if(void 0!==t){const{error:s}=t;e=s?"Ошибка загрузки товара":this.renderProduct(t)}return super.render((t=>`\n      <div class="product-details">\n        <div class="product-details__container container">\n          ${""!==t?t:e}\n        </div>\n      </div>\n    `))}}class Q extends y{constructor(t){super({...t,viewConstructor:J}),this.handleAppLoad=t=>{const{products:e}=t.detail,{id:s}=G.getQueryParams(),n=e.find((t=>t.id===s));if(void 0===n)return G.change("not-found");this.onLoadingEnd({...t.detail,product:n})},this.onLoadingStart(),this.on(s.LOAD_APP,this.handleAppLoad)}}const K={[r.LIST]:'\n    <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M10 7V11H22V7H10ZM10 21H22V17H10V21ZM10 16H22V12H10V16ZM5 11H9V7H5V11ZM5 21H9V17H5V21ZM5 16H9V12H5V16Z"/>\n    </svg>   \n  ',[r.GRID]:'\n    <svg width="28" height="28" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">\n      <path d="M5 13H13V5H5V13ZM5 23H13V15H5V23ZM15 23H23V15H15V23ZM15 5V13H23V5"/>\n    </svg>\n  '};class X extends L{constructor(t){super({...t,root:".products__display-options"})}renderButtons({inputName:t,values:e}){return e.map((e=>`<label class="radio-group__item radio">\n          <input type="radio" name="${t}" value="${e}" checked="${e===i}">\n          <div class="radio__button">\n            ${K[e]}        \n          </div>\n        </label>`)).join("")}render(t){return super.render(`\n      <div class="products__display-options">\n        <div class="radio-group">\n          <form class="radio-group__form">\n            ${this.renderButtons(t)}\n          </form>\n        </div>\n      </div>\n    `)}}class tt extends y{constructor(t){super({...t,viewConstructor:X}),this.handleAppLoad=t=>{const{displayOption:e}=t.detail.state.appearance;this.radioElements?.forEach((t=>{t instanceof HTMLInputElement&&t.getAttribute("value")===e&&(t.checked=!0)}))},this.onChange=t=>{const e=t.currentTarget;if(null!==e&&e instanceof HTMLFormElement){const t=new FormData(e).get(tt.nameAttrValue);this.emit(s.CHANGE_DISPLAY_OPTION,t)}},this.radioElements=null,this.on(s.LOAD_APP,this.handleAppLoad)}render(){return super.render({inputName:tt.nameAttrValue,values:Object.values(r),checked:i})}afterRender(){super.afterRender(),this.radioElements=this.getRoot().querySelectorAll(`input[name="${tt.nameAttrValue}"]`),f(this.getRoot())(".radio-group__form").addEventListener("change",this.onChange)}}tt.nameAttrValue="display-options";class et extends L{constructor(t){super({...t,root:".products__sort"})}renderOptions(){return Object.entries(m).map((([t,[e]])=>`<option value="${t}">${e}</option>`)).join("")}render(t){return super.render(`\n      <div class="products__sort">\n        <div class="select">\n          <div class="select__title">Сортировать</div>\n          <select class="select__input" name="products-sort" value="${t?.value||d.TITLE_ASC}">\n            ${this.renderOptions()}\n          </select>\n        </div>\n      </div>\n    `)}}class st extends y{constructor(t){super({...t,viewConstructor:et}),this.handleAppLoad=({detail:{state:t}})=>{this.inputEl&&(this.inputEl.value=t.sort)},this.onChange=()=>{this.inputEl&&this.emit(s.CHANGE_SORT,this.inputEl.value)},this.inputEl=null,this.on(s.LOAD_APP,this.handleAppLoad)}afterRender(){super.afterRender();const t=f(this.getRoot())("select");t instanceof HTMLSelectElement&&(this.inputEl=t,this.inputEl.addEventListener("change",this.onChange))}}class nt extends L{constructor(t){super({...t,root:".products__amount"})}render(t){const e=void 0!==t?`Найдено товаров: ${t}`:"";return super.render(`\n      <div class="products__amount">\n        <span>${e}</span>\n      </div>\n    `)}}class rt extends y{constructor(t){super({...t,viewConstructor:nt}),this.handleProductsListUpdate=t=>{const{products:e}=t.detail;this.update(e.length)},this.on(s.UPDATE_PRODUCTS_LIST,this.handleProductsListUpdate),this.on(s.LOAD_APP,this.handleProductsListUpdate)}}class it extends L{constructor(t){super({...t,root:".products__header"})}render(){return super.render(`\n      <div class="products__header">\n        ${this.renderChild("productsSort",st)}\n        ${this.renderChild("productsAmount",rt)}\n        ${this.renderChild("productsDisplayOptions",tt)}\n      </div>\n    `)}}class at extends L{constructor(t){super({...t,root:".products-list__item"})}render(t){const{product:{title:s,price:n,rating:r,imgs:i,id:a}}=t,o=`${e}/${i[0]}`;return C(o).then((t=>{const e=f(this.getRoot())(".product__img img");e instanceof HTMLImageElement&&(e.src=t)})),super.render(`\n      <li class="products-list__item product" data-product-id="${a}">\n        <div class="product__img">\n          <img\n            src="${B}"\n            alt="${s}">\n        </div>\n        <div class="product__description">\n          <h3 class="product__title">${s}</h3>\n          <p class="product__extra">\n            ${t.product.props.additionalInfo?.specs.equipment?.value}\n            ${t.product.props.additionalInfo?.specs.extra?.value}\n          </p>\n          <div class="product__buy">\n            <div class="product__price">${n} ₽</div>\n            ${this.renderChild("addToCart",q,{data:t,viewOptions:{data:{isInCart:t.isInCart}}})}\n          </div>\n          <div class="product__info">\n            ${this.renderChild("productRating",y,{viewConstructor:Z,viewOptions:{data:{rating:r}}})}\n          </div>\n        </div>\n      </li>\n    `)}}class ot extends A{constructor(t){super({...t,root:".products__list"})}renderItems(t){const{products:e,state:{productInCartIds:s}}=t;return e.map((t=>this.renderChild("productsListItem",y,{viewOptions:{data:{product:t,isInCart:Object.keys(s).includes(t.id)}},viewConstructor:at}))).join("")}render(t){let e="";if(void 0!==t){const s=ot.className,{error:n,products:r}=t,i=`${s}_${t.displayOption}`;e=n?"Ошибка загрузки товаров":0===r.length?'<p class="products__empty">Товары не найдены! Попробуйте изменить критерии фильтрации.</p>':`<ul class="${s} ${i}">${this.renderItems(t)}</ul>`}return super.render((t=>`\n      <div class="products__list">\n        ${""!==t?t:e}\n      </div>\n    `))}}ot.className="products-list";class ct extends y{constructor(t){super(t),this.oldItemsInfo=[],this.animate=!0}getListItemsInfo(){const t=this.getRoot().querySelector(".products-list");return null!==t?function(t,e=(()=>null)){return Array.from(t.children).map((t=>{const s=t.getBoundingClientRect();return{id:e(t),element:t,x:s.left,y:s.top,width:s.right-s.left,height:s.bottom-s.top}}))}(t,(t=>t.getAttribute("data-product-id"))):[]}update(t){this.oldItemsInfo=this.getListItemsInfo(),super.update(t)}afterRender(){super.afterRender();const t=this.getListItemsInfo();0!==this.oldItemsInfo.length&&0!==t.length&&this.animate&&function(t,e){for(const r of e){const e=t.find((t=>t.id===r.id));if(void 0===e||(n=r,(s=e).id===n.id&&s.x===n.x&&s.y===n.y&&s.width===n.width&&s.height===n.height))continue;const i=e.x-r.x,a=e.y-r.y,o=e.width/r.width,c=e.height/r.height;r.element.animate([{transform:`translate(${i}px, ${a}px) scale(${o}, ${c})`},{transform:"none"}],{duration:250,easing:"ease-out"})}var s,n}(this.oldItemsInfo,t)}}class dt extends ct{constructor(t){super({...t,viewConstructor:ot}),this.handleAppLoad=t=>{const{displayOption:e}=t.detail.state.appearance;this.displayOption=e,this.onLoadingEnd({...t.detail,displayOption:e})},this.handleProductsListUpdate=t=>{const{displayOption:e}=this;this.update({...t.detail,displayOption:e})},this.handleChangeDisplayOption=t=>{const e=this.displayOption;this.displayOption=t.detail;const s=ot.className,n=this.getRoot().querySelector(`.${s}`);null!==n&&n.classList.replace(`${s}_${e}`,`${s}_${this.displayOption}`)},this.handleClick=t=>{const e=t.target;if(null===e||!(e instanceof HTMLElement))return;if(null!==e.closest(".product__add-to-cart"))return;const s=e.closest(".product");if(null===s||!(s instanceof HTMLElement))return;const n=s.getAttribute("data-product-id");null!==n&&G.change(`product?id=${n}`)},this._displayOption=i,this.onLoadingStart(),this.on(s.LOAD_APP,this.handleAppLoad),this.on(s.UPDATE_PRODUCTS_LIST,this.handleProductsListUpdate),this.on(s.CHANGE_DISPLAY_OPTION,this.handleChangeDisplayOption)}get displayOption(){return this._displayOption}set displayOption(t){this.animate=t===r.GRID,this._displayOption=t}afterRender(){super.afterRender(),this.getRoot().addEventListener("click",this.handleClick)}}class lt extends y{constructor(t){const{data:e}=t;if(void 0===e)throw new TypeError;super(t),this.getFilterData=t=>({}),this.name=e.name,this.title=e.title,this.propPicker=Rt[e.name][2],this.style=e.filterStyle||""}check(t){return void 0!==t&&void 0!==this.propPicker(t)}getName(){return this.name}getState(){return{}}reset(){}getTag(){const{name:t,title:e}=this;return{name:t,title:e,isSmthToPrint:!1,info:""}}handleChange(){this.emit(s.CHANGE_FILTER,this.name)}updateProductNumbers(t){}}class ht extends L{constructor(t){super({...t,root:".checkbox__products-number"})}render(t){const e=t?`&nbsp;(${t})`:"";return super.render(`\n      <span class="checkbox__products-number">${e}</span>\n    `)}}class ut extends L{constructor(t){super({...t,root:".checkbox-list"})}renderItems(t){const{inputName:e,values:s,checkedValues:n,style:r}=t,i=Object.entries(a);return Object.keys(s).map((t=>{const a=i.find((([e,s])=>s===t))||["white"],o="color-pick"===r?`style="background-color: ${a[0]};"`:"";return`<li class="checkbox-list__item">\n          <label class="checkbox">\n            <input type="checkbox" name="${e}" value="${t}" ${n.includes(t)?"checked":""}>\n            <span class="checkbox__check" ${o}></span>\n            <span class="checkbox__title">${t}</span>\n            ${this.renderChild("productsNumber",y,{viewConstructor:ht,viewOptions:{data:s[t]}})}\n          </label>\n        </li>`})).join("")}render(t){const{style:e}=t,s=""!==e?`checkbox-list_${e}`:"";return super.render(`\n      <ul class="checkbox-list ${s}">\n        ${this.renderItems(t)}\n      </ul>\n    `)}}class pt extends lt{constructor(t){super({...t,viewConstructor:ut}),this.handleChange=()=>{if(!this.checkboxes)return;const t=[...this.checkboxes].reduce(((t,e)=>e instanceof HTMLInputElement&&e.checked?[...t,e.value]:t),[]);this.checkedValues=[...t],super.handleChange()},this.getFilterData=t=>t.reduce(((t,e)=>{const s=this.propPicker(e);if(!s||"string"!=typeof s)return t;const n=s.split(",").map((t=>t.trim()));return 1===n.length?t[s]=t[s]?t[s]+1:1:n.forEach((e=>{t[e]=t[e]?t[e]+1:1})),t}),{});const{data:e}=t;if(void 0===e)throw new TypeError;this.checkedValues=e.state?.checkedValues||[],this.values=this.getFilterData(e.products),this.checkboxes=null}render(){const{values:t,checkedValues:e,style:s}=this;return super.render({inputName:this.name,values:t,checkedValues:e,style:s})}afterRender(){super.afterRender(),this.checkboxes=this.getRoot().querySelectorAll(`input[name="${this.name}"]`),this.checkboxes.forEach((t=>{t.addEventListener("change",this.handleChange)}))}check(t){if(0===this.checkedValues.length)return!0;const e=this.propPicker(t);return!(!e||"string"!=typeof e)&&e.split(",").map((t=>t.trim())).some((t=>this.checkedValues.includes(t)))}getState(){return{checkedValues:this.checkedValues}}reset(){0!==this.checkedValues.length&&(this.checkedValues=[],this.update())}getTag(){const{checkedValues:t}=this;return{...super.getTag(),isSmthToPrint:0!==t.length,info:t.join(", ")}}updateProductNumbers(t){const e=JSON.parse(JSON.stringify(this.values)),s=this.getFilterData(t);Object.keys(e).forEach((t=>{e[t]=void 0!==s[t]?s[t]:0}));const n=Object.values(e),r=this.getComponent("productsNumber");Array.isArray(r)?r.forEach(((t,e)=>t.update(n[e]))):r.update(n[0])}}class _t extends L{constructor(t){super({...t,root:".range"})}renderInput(t,e,s){const{min:n,max:r,inputName:i,step:a}=t;return`\n      <input class="${s}"\n        name="${i}"\n        type="range"\n        min="${n}"\n        max="${r}"\n        value="${e}"\n        step="${a}">`}render(t){const{min:e,max:s,left:n,right:r}=t;return super.render(`\n      <label class="range">\n        <span class="range__min">${e}</span>\n        <div class="range__container">\n          <div class="range__track">\n            <div class="range__track-inner"></div>\n          </div>\n          ${this.renderInput(t,n,"range__input-left range__input_top")}\n          ${this.renderInput(t,r,"range__input-right")}\n        </div>\n        <span class="range__max">${s}</span>\n      </label>\n    `)}}class gt extends y{constructor(t){super({...t,viewConstructor:_t}),this.handleChange=()=>{const{left:t,right:e}=this;this.handlers?.onChange({left:t,right:e})},this.handleLeftRangeFocus=()=>{this.leftInputEl?.classList.add("range__input_top"),this.rightInputEl?.classList.remove("range__input_top")},this.handleRightRangeFocus=()=>{this.leftInputEl?.classList.remove("range__input_top"),this.rightInputEl?.classList.add("range__input_top")},this.handleLeftRangeChange=t=>{const e=t.target;if(!(e instanceof HTMLInputElement))return;const s=Number(e.value);if(s>this.right)return e.value=String(this.right),t.preventDefault();this.left=s,v(this.minEl).textContent=`${s}`,this.setTrackWidth()},this.handleRightRangeChange=t=>{const e=t.target;if(!(e instanceof HTMLInputElement))return;const s=Number(e.value);if(s<this.left)return e.value=String(this.left),t.preventDefault();this.right=s,v(this.maxEl).textContent=`${s}`,this.setTrackWidth()},this.minEl=null,this.maxEl=null,this.trackEl=null,this.leftInputEl=null,this.rightInputEl=null;const{data:e}=t;if(!e)throw new TypeError;const{min:s,max:n,left:r,right:i}=e;this.min=s,this.max=n,this.left=r>=s&&r<=n?r:s,this.right=i>=s&&i<=n?i:n}render(){const{min:t,max:e,left:s,right:n}=this,r=Number.isInteger(s)&&Number.isInteger(n)?1:.1;return super.render({inputName:this.name,min:t,max:e,left:s,right:n,step:r})}afterRender(){super.afterRender();const t=f(this.getRoot());this.minEl=t(".range__min"),this.maxEl=t(".range__max"),this.trackEl=t(".range__track-inner"),this.leftInputEl=t(".range__input-left"),this.rightInputEl=t(".range__input-right"),this.leftInputEl.addEventListener("input",this.handleLeftRangeChange),this.rightInputEl.addEventListener("input",this.handleRightRangeChange),this.leftInputEl.addEventListener("focus",this.handleLeftRangeFocus),this.rightInputEl.addEventListener("focus",this.handleRightRangeFocus),this.leftInputEl.addEventListener("change",this.handleChange),this.rightInputEl.addEventListener("change",this.handleChange),this.setTrackWidth()}setTrackWidth(){const{min:t,max:e,left:s,right:n}=this,r=(s-t)/(e-t)*100,i=100-r-(e-n)/(e-t)*100;v(this.trackEl).style.left=`${r}%`,v(this.trackEl).style.width=`${i}%`}}class mt extends lt{constructor(t){super(t),this.handleChange=t=>{if(!t)return;const{left:e,right:s}=t;e===this.left&&s===this.right||(this.left=e,this.right=s,super.handleChange())},this.getFilterData=t=>{const e=t.map((t=>Number(this.propPicker(t))));return{min:Math.min(...e),max:Math.max(...e)}};const{data:e}=t;if(void 0===e)throw new TypeError;const{min:s,max:n}=this.getFilterData(e.products);this.left=e.state?.left||s,this.right=e.state?.right||n,this.min=s,this.max=n}check(t){const e=Number(this.propPicker(t));return e>=this.left&&e<=this.right}getState(){const{left:t,right:e}=this;return{left:t,right:e}}reset(){const{min:t,max:e}=this;this.left===t&&this.right===e||(this.left=t,this.right=e,this.update())}render(){const{left:t,right:e,min:s,max:n}=this;return super.render(),this.renderChild("filterContent",gt,{handlers:{onChange:this.handleChange},data:{min:s,max:n,left:t,right:e}})}getTag(){const{left:t,right:e,min:s,max:n}=this,r=t!==s||e!==n;return{...super.getTag(),isSmthToPrint:r,info:t===e?`${t}`:`${t}-${e}`}}}class vt extends L{constructor(t){super({...t,root:".switch"})}render(t){const{inputName:e,checked:s,title:n,matchedProductsNumber:r}=t;return super.render(`\n      <div class="switch">\n        <label class="checkbox">\n          <input type="checkbox" name="${e}" ${s?"checked":""}>\n          <span class="checkbox__check"></span>\n          <span class="checkbox__title">${n}</span>\n          ${this.renderChild("productsNumber",y,{viewConstructor:ht,viewOptions:{data:r}})}\n        </label>\n      </div>\n    `)}}var ft;!function(t){t.YES="есть",t.NO="нет"}(ft||(ft={}));class Ct extends lt{constructor(t){super({...t,viewConstructor:vt}),this.handleChange=()=>{this.checkbox&&(this.checkbox instanceof HTMLInputElement&&(this.checked=this.checkbox.checked),super.handleChange())},this.getFilterData=t=>t.reduce(((t,e)=>{const s=this.propPicker(e);return t+Number(s===ft.YES)}),0);const{data:e}=t;if(void 0===e)throw new TypeError;this.matchedProductsNumber=this.getFilterData(e.products),this.checked=e.state?.checked||!1,this.checkbox=null}render(){const{checked:t,title:e,name:s,matchedProductsNumber:n}=this;return super.render({checked:t,title:e,inputName:s,matchedProductsNumber:n})}afterRender(){super.afterRender(),this.checkbox=f(this.getRoot())(`input[name="${this.name}"]`),this.checkbox.addEventListener("change",this.handleChange)}check(t){return!this.checked||String(this.propPicker(t))===ft.YES===this.checked}getState(){return{checked:this.checked}}reset(){this.checked&&(this.checked=!1,this.update())}getTag(){return{...super.getTag(),isSmthToPrint:this.checked,info:""}}updateProductNumbers(t){this.matchedProductsNumber=this.getFilterData(t);const e=this.getComponent("productsNumber");Array.isArray(e)||e.update(this.matchedProductsNumber)}}class Et extends L{constructor(t){super({...t,root:".search"})}render(t){const{inputName:e,value:s,title:n}=t;return super.render(`\n      <div class="search">\n        <input class="search__input text"\n          type="text"\n          autocomplete="off"\n          name="${e}"\n          value="${s}"\n          placeholder="${n}">\n        <button class="search__clear">\n          <i class="fa-solid fa-xmark"></i>\n        </button>\n        <button class="search__submit">\n          <i class="fa-solid fa-magnifying-glass"></i>\n        </button>\n      </div>\n    `)}}const Rt={[n.SEARCH]:["Поиск по названию",class extends lt{constructor(t){super({...t,viewConstructor:Et}),this.handleClear=()=>{this.value="",null!==this.searchInput&&(this.searchInput.value=""),this.handleChange()},this.handleInput=t=>{const e=t.target;e instanceof HTMLInputElement&&this.value!==e.value&&(this.value=e.value,this.handleChange())};const{data:e}=t;if(void 0===e)throw new TypeError;this._value=e.state?.value||"",this.searchInput=null}get value(){return this._value}set value(t){this._value=t,this.toogleClearBtn()}toogleClearBtn(){const t=""===this.value?"remove":"add";this.getRoot().classList[t]("search_show-clear")}render(){const{title:t,name:e,value:s}=this;return super.render({title:t,inputName:e,value:s})}afterRender(){super.afterRender(),this.toogleClearBtn();const t=f(this.getRoot())(`input[name="${this.name}"]`);t instanceof HTMLInputElement&&(t.addEventListener("input",E.call(this,200,this.handleInput)),this.searchInput=t,this.searchInput.focus()),f(this.getRoot())(".search__clear").addEventListener("click",this.handleClear),f(this.getRoot())(".search__submit").addEventListener("click",this.handleChange)}check(t){return""===this.value||String(this.propPicker(t)).toLowerCase().includes(this.value.toLowerCase())}getState(){return{value:this.value}}reset(){""!==this.value&&(this.value="",this.update())}getTag(){return{...super.getTag(),isSmthToPrint:""!==this.value,info:`'${this.value}'`}}},c[o.TITLE],[!1]],[n.CAMERA_INCLUDED]:["Наличие камеры в комплекте",Ct,c[o.CAMERA_INCLUDED],[!1]],[n.MOBILE_CONTROL]:["Управление со смартфона",Ct,c[o.MOBILE_CONTROL],[!1]],[n.BRAND]:["Бренд",pt,c[o.BRAND]],[n.COLOR]:["Цвет",pt,c[o.COLOR],[!0,"color-pick"]],[n.SIZE]:["Размер",pt,c[o.SIZE]],[n.YEAR]:["Год выпуска",mt,c[o.YEAR]],[n.PRICE]:["Цена (₽)",mt,c[o.PRICE]],[n.WEIGHT]:["Полетная масса (ПМ) (гр.)",mt,c[o.WEIGHT]]};class Tt extends L{constructor(t){super({...t,root:".filters-list__item"})}render(t){const{name:e,title:s,isExpandable:n,isExpanded:r}=t,[i,a]=Rt[e];return super.render(`\n      <li class="filters-list__item filter ${n?"":"filter_no-expander"}">\n        <input class="filter__expander"\n          type="checkbox"\n          name="${e}"\n          value="${e}"\n          id="${e}"\n          ${r?"":"checked"}> \n        <div class="filter__expander-wrapper">\n          <label class="filter__expander-label" for="${e}">\n            <h2 class="filter__title">${s}</h2>\n            <div class="filter__expander-icon">\n              <i class="fa-solid fa-chevron-up"></i>\n            </div>\n          </label>\n        </div>\n        <div class="filter__content">\n          ${this.renderChild("filter",a,{data:t,viewOptions:{root:".filter__content"}})}\n        </div>\n      </li>\n    `)}}class Lt extends y{constructor(t){super({...t,viewConstructor:Tt}),this.handleExpand=t=>{const e=t.currentTarget;e instanceof HTMLInputElement&&(this.isExpanded=!e.checked,this.emit(s.CHANGE_FILTER_APPEARANCE,{filterName:e.name,isExpanded:this.isExpanded}))};const{data:e}=t;if(void 0===e)throw new TypeError;this.isExpanded=e.isExpanded}afterRender(){super.afterRender(),f(this.getRoot())(".filter__expander").addEventListener("change",this.handleExpand)}}class It extends A{constructor(t){super({...t,root:".filters"})}renderItems({products:t,state:{filterStates:e,appearance:s}}){return Object.entries(Rt).map((([n,[r,i,a,o]])=>{const[c=!0,d=""]=o||[],{isExpanded:l=!0}=s?.filters[n]||{},h={name:n,title:r,products:t,isExpandable:c,isExpanded:l,filterStyle:d,state:e[n]};return this.renderChild("filterItems",Lt,{viewConstructor:Tt,viewOptions:{data:h},data:h})})).join("")}render(t){let e="";if(void 0!==t){const{error:s}=t;e=s?"Ошибка загрузки товаров":`<ul class="filters__list filters-list">\n              ${this.renderItems(t)}\n          </ul>`}return super.render((t=>`\n      <div class="filters">\n        ${""!==t?t:e}\n      </div>\n    `))}}class At extends y{constructor(t){super({...t,viewConstructor:It}),this.handleResetFilter=t=>{const{filterName:e}=t.detail,n=this.getFilters(),r=n.find((t=>t.getName()===e));void 0!==r&&(this.lastChangedFilter=e,r.reset(),this.emit(s.CHANGE_FILTERS,n))},this.handleResetFilters=()=>{this.lastChangedFilter="";const t=this.getFilters();t.forEach((t=>t.reset())),this.emit(s.CHANGE_FILTERS,t)},this.handleFiltersChange=t=>{t&&(this.lastChangedFilter=t.detail);const e=this.getFilters();this.emit(s.CHANGE_FILTERS,e)},this.handleAppLoad=t=>{this.onLoadingEnd(t.detail),queueMicrotask((()=>this.handleFiltersChange()))},this.handleFiltersProductNumbersUptade=t=>{this.getFilters().forEach((e=>{e.getName()!==this.lastChangedFilter&&e.updateProductNumbers(t.detail)}))},this.lastChangedFilter="",this.on(s.LOAD_APP,this.handleAppLoad),this.on(s.UPDATE_FILTERS_PRODUCT_NUMBERS,this.handleFiltersProductNumbersUptade),this.on(s.CHANGE_FILTER,this.handleFiltersChange),this.on(s.RESET_FILTERS,this.handleResetFilters),this.on(s.RESET_FILTER,this.handleResetFilter),this.onLoadingStart()}getFilters(){const{filterItems:t}=this.getComponents();if(Array.isArray(t)){const e=t.map((t=>t.getComponent("filter")));if(e.every((t=>!Array.isArray(t)&&t instanceof lt)))return e}return[]}}class St extends L{constructor(t){super({...t,root:".controls__reset-settings"})}render(){return super.render('\n      <div class="controls__reset-settings">\n        <button class="button">\n          Сбросить настройки\n        </button>\n      </div>\n    ')}}class yt extends H{constructor(t){super({...t,viewConstructor:St}),this.onClick=async()=>{this.emit(s.RESET_SETTINGS)}}}class wt extends L{constructor(t){super({...t,root:".controls__reset-filters"})}render(){return super.render('\n      <div class="controls__reset-filters">\n        <button class="button">\n          Сбросить фильтры\n        </button>\n      </div>\n    ')}}class $t extends H{constructor(t){super({...t,viewConstructor:wt}),this.onClick=async()=>{this.emit(s.RESET_FILTERS)}}}class bt extends L{constructor(t){super({...t,root:".selected-filters"})}renderFilterTags(t){return t.map((t=>{const{name:e,title:s,isSmthToPrint:n,info:r}=t.getTag();return n?`<div class="selected-filters__item" data-filter-name="${e}">\n              <span class="selected-filters__item-title">${s}</span>\n              ${""!==r?`: <span class="selected-filters__item-info">${r}</span>`:""}\n            </div>`:""})).join("")}render(t){let e="";return t&&(e=this.renderFilterTags(t)),super.render(`\n      <div class="products__selected-filters selected-filters">\n        ${e}\n      </div>\n    `)}}class xt extends y{constructor(t){super({...t,viewConstructor:bt}),this.handleClick=t=>{const e=t.target;if(null==e||!(e instanceof HTMLElement))return;const n=e.closest(".selected-filters__item");if(null===n)return;const r=n.getAttribute("data-filter-name");this.emit(s.RESET_FILTER,{filterName:r})},this.handleFiltersChange=t=>{this.onLoadingEnd(t.detail)},this.on(s.CHANGE_FILTERS,this.handleFiltersChange),this.onLoadingStart()}afterRender(){super.afterRender(),this.getRoot().addEventListener("click",this.handleClick)}}class kt extends L{constructor(t){super({...t,root:".shop"})}render(){return super.render(`\n      <div class="shop">\n        <div class="shop__overlay"></div>\n        <div class="shop__container container">\n          <aside class="shop__left">\n            <div class="controls">\n              ${this.renderChild("resetFiltersBtn",$t)}\n              ${this.renderChild("resetSettingsBtn",yt)}\n            </div>\n            ${this.renderChild("filters",At)}\n          </aside>\n          <div class="shop__right">\n            <div class="products">\n              ${this.renderChild("productsHeader",y,{viewConstructor:it})}\n              ${this.renderChild("selectedFilters",xt)}\n              ${this.renderChild("productsList",dt)}\n            </div>\n          </div>\n        </div>\n      </div>\n    `)}}class Ot extends y{constructor(t){super({...t,viewConstructor:kt}),this.handleToogleMainLeft=t=>{const e=t=>`${t}_show`,s=t=>`${t}_hide`,n=`${Ot.asideClass}__left`,r=`${Ot.asideClass}__overlay`;t.detail?(this.leftSideEl?.classList.add(e(n)),this.overlayEl?.classList.add(e(r))):(this.leftSideEl?.classList.remove(e(n)),this.overlayEl?.classList.remove(e(r)),this.leftSideEl?.classList.add(s(n)),this.overlayEl?.classList.add(s(r)),setTimeout((()=>{this.leftSideEl?.classList.remove(s(n)),this.overlayEl?.classList.remove(s(r))}),250))},this.leftSideEl=null,this.overlayEl=null,this.on(s.TOGGLE_MAIN_LEFT,this.handleToogleMainLeft)}afterRender(){super.afterRender(),this.leftSideEl=f(this.getRoot())(`.${Ot.asideClass}__left`),this.overlayEl=f(this.getRoot())(`.${Ot.asideClass}__overlay`)}}Ot.asideClass="shop";class Dt extends L{constructor(t){super({...t,root:".cart-product"})}render(t){const{title:s,price:n,imgs:r,id:i}=t.product,a=`${e}/${r[0]}`;return C(a).then((t=>{const e=f(this.getRoot())(".cart-product__img img");e instanceof HTMLImageElement&&(e.src=t)})),`\n      <li class="cart-details-products__item cart-product">\n        <div class="cart-product__img">\n          <a href="#product?id=${i}">\n            <img\n              src="${B}"\n              alt="${s}">\n          </a>\n        </div>\n        <div class="cart-product__content">\n          <h3 class="cart-product__title">\n            <a href="#product?id=${i}">${s}</a>\n          </h3>\n          <div class="cart-product__count">\n            <button class="button button_icon cart-product__sub-btn">-</button>\n            <span class="cart-product__counter">${t.productsAmount}</span>\n            <button class="button button_icon cart-product__add-btn">+</button>\n          </div>\n        </div>\n        <div class="cart-product__right">\n          <div class="cart-product__price">\n            <span class="cart-product__price-value">${t.productsAmount*n}</span> ₽\n          </div>\n          <button class="button cart-product__delete-btn">\n            <i class="fa-solid fa-trash-can"></i>\n          </button>\n        </div>\n      </li>`}}class Pt extends y{constructor(t){super({...t,viewConstructor:Dt}),this.handleTryAddToCart=t=>()=>{const{product:{id:e},handleAddToCart:n}=this;this.emit(s.TRY_ADD_TO_CART,{productId:e,inc:t,handleAddToCart:n})},this.handleAddToCart=t=>{if(0===t)return this.handleDeleteFromCart();null!==this.counterEl&&(this.counterEl.textContent=`${t}`),null!==this.priceEl&&(this.priceEl.textContent=""+t*this.product.price)},this.handleDeleteProductClick=()=>{const{product:{id:t},handleDeleteFromCart:e}=this;this.emit(s.TRY_DELETE_FROM_CART,{productId:t,handleDeleteFromCart:e})},this.handleDeleteFromCart=()=>{this.remove()};const{data:e}=t;if(void 0===e)throw new TypeError;this.product=JSON.parse(JSON.stringify(e.product)),this.counterEl=null,this.priceEl=null}afterRender(){super.afterRender(),f(this.getRoot())(".cart-product__add-btn").addEventListener("click",this.handleTryAddToCart(1)),f(this.getRoot())(".cart-product__sub-btn").addEventListener("click",this.handleTryAddToCart(-1)),f(this.getRoot())(".cart-product__delete-btn").addEventListener("click",this.handleDeleteProductClick),this.counterEl=f(this.getRoot())(".cart-product__counter"),this.priceEl=f(this.getRoot())(".cart-product__price-value")}}class Nt extends A{constructor(t){super({...t,root:".cart-details"})}renderProducts(t){const{state:{productInCartIds:e},products:s}=t;return`\n      <ul class="cart-details__products cart-details-products">\n        ${s.filter((({id:t})=>Object.keys(e).includes(t))).map((t=>this.renderChild("products",Pt,{data:{product:t},viewOptions:{data:{product:t,productsAmount:e[t.id]}}}))).join("")}\n      </ul>\n    `}renderCart(t){const{state:{productInCartIds:e},products:s}=t,n=Object.keys(e).reduce(((t,s)=>t+e[s]),0),r=R(e,s);return`\n      <h2 class="cart-details__title page-title">Корзина\n        <span class="cart-details__products-amount">\n          всего товаров: <span>${n}</span>\n        <span>\n      </h2>\n      <div class="cart-details__content">\n        ${0!==n?`<div class="cart-details__left">${this.renderProducts(t)}</div>\n        <div class="cart-details__right">\n          <div class="cart-details__total">\n            <div class="cart-details__total-title">Итого:</div>\n            <div class="cart-details__total-content">\n              <span class="cart-details__total-value">${r}</span> ₽\n            </div>\n          </div>\n          <button class="button">Оформить заказ</button>\n          <a class="button" href="#">Продолжить покупки</a>\n        </div>`:'<div class="cart-details__empty"><a class="button" href="#">За покупками</a></div>'}\n      </div>\n    `}render(t){let e="";if(void 0!==t){const{error:s}=t;e=s?"Ошибка загрузки товаров":this.renderCart(t)}return super.render((t=>`\n      <div class="cart-details">\n        <div class="cart-details__container container">\n          ${""!==t?t:e}\n        </div>\n      </div>\n    `))}}class Ft extends y{constructor(t){super({...t,viewConstructor:Nt}),this.handleAppLoad=t=>{this.onLoadingEnd(t.detail)},this.handleAddToCart=t=>{const{productsAmount:e,totalSum:s}=t.detail;null!==this.productsAmountEl&&(this.productsAmountEl.textContent=`${e}`),this.totalSumEl&&(this.totalSumEl.textContent=`${s}`)},this.productsAmountEl=null,this.totalSumEl=null,this.onLoadingStart(),this.on(s.LOAD_APP,this.handleAppLoad),this.on(s.ADD_TO_CART,this.handleAddToCart)}afterRender(){super.afterRender();const t=this.getRoot().querySelector(".cart-details__products-amount span");null!==t&&(this.productsAmountEl=t);const e=this.getRoot().querySelector(".cart-details__total-value");null!==e&&(this.totalSumEl=e)}}class Ht extends L{render(){return super.render(`\n      ${this.renderChild("alert",U)}\n      ${this.renderChild("header",y,{viewConstructor:V})}\n      <main class="main">\n        ${this.renderChild("router",Y,{viewOptions:{root:".main"},data:{routes:{"#":["shopPage",Ot],"#cart":["cartPage",Ft],"#product":["productPage",Q]}}})}\n      </main>\n      ${this.renderChild("footer",y,{viewConstructor:x})}\n    `)}}class Mt extends EventTarget{constructor(){super()}on(t,e){const s=(t=>e=>{if(!function(t){return"detail"in t}(e))throw new TypeError;t(e)})(e);return this.addEventListener(t,s),()=>{this.removeEventListener(t,s)}}emit(t,e){this.dispatchEvent(new CustomEvent(t,{detail:e}))}}new class extends ${constructor(t,e){super({...t,viewConstructor:Ht,viewOptions:{root:f(document)(e)}}),this.handleDataLoad=async t=>(this.products=t,this.loadState()),this.handleFiltersChange=t=>{const e=t.detail;this.state.filterStates=e.reduce(((t,e)=>(t[e.getName()]=e.getState(),t)),{});const n=this.products.filter((t=>e.reduce(((e,s)=>e&&s.check(t)),!0)));var r,i;this.sort.call(null,n),r=this.filtred,i=n,r.length===i.length&&r.every(((t,e)=>i[e].id===t.id))||(this.filtred=n,this.updateProductsList(),this.emit(s.UPDATE_FILTERS_PRODUCT_NUMBERS,this.filtred))},this.handleChangeDisplayOption=t=>{this.state.appearance.displayOption=t.detail},this.handleTryAddToCart=t=>{const{productInCartIds:e}=this.state,{productId:n,inc:r,handleAddToCart:i}=t.detail,a=this.products.find((t=>t.id===n));let o=Object.keys(e).reduce(((t,s)=>t+e[s]),0);if(void 0!==a){if(20===o&&r>0)return this.emit(s.SHOW_ALERT,"Извините, все слоты в корзине (20) заполнены!");const{id:t}=a;if(r<0&&(void 0===e[t]||1===e[t]))return;if(void 0!==e[t]){const s=e[t]+r;0===s?delete e[t]:e[t]=s}else e[t]=1;o+=r;const n=R(e,this.products);this.emit(s.ADD_TO_CART,{productsAmount:o,totalSum:n}),i(e[t]||0),0===o&&this.handleAppLoad(null)}},this.handleTryDeleteFromCart=t=>{const{productInCartIds:e}=this.state,{productId:n,handleDeleteFromCart:r}=t.detail,i=this.products.find((t=>t.id===n));if(void 0!==i){const{id:t}=i;if(void 0===e[t])return;delete e[t];const n=Object.keys(e).reduce(((t,s)=>t+e[s]),0),a=R(e,this.products);this.emit(s.ADD_TO_CART,{productsAmount:n,totalSum:a}),r(),0===n&&this.handleAppLoad(null)}},this.handleChangeSort=t=>{this.state.sort!==t.detail&&(this.state.sort=t.detail,this.sort.call(null,this.filtred),this.updateProductsList())},this.handleAppLoad=async(t=null)=>{const e=t?[]:this.filtred;this.emit(s.LOAD_APP,{products:e,state:this.state,error:t})},this.handleStateLoad=async t=>{null===t?this.saveState():this.state=t,this.filtred=[...this.products],this.sort.call(null,this.filtred),this.handleAppLoad(null)},this.handleResetSettings=async()=>{this.state=this.getDefaultState(),this.handleStateLoad(null)},this.handleFilterAppearanceChange=t=>{const{filterName:e,isExpanded:s}=t.detail;this.state.appearance.filters[e]={isExpanded:s}},this.handlePageChange=()=>{this.filtred=[...this.products],this.sort.call(null,this.filtred);const t=this.getComponent("header");Array.isArray(t)||t.update(),this.emit(s.LOAD_APP,{products:this.filtred,state:this.state,error:null})},this.productsService=new T,this.products=[],this.filtred=[],this.on(s.CHANGE_FILTERS,this.handleFiltersChange),this.on(s.TRY_ADD_TO_CART,this.handleTryAddToCart),this.on(s.TRY_DELETE_FROM_CART,this.handleTryDeleteFromCart),this.on(s.CHANGE_SORT,this.handleChangeSort),this.on(s.RESET_SETTINGS,this.handleResetSettings),this.on(s.CHANGE_DISPLAY_OPTION,this.handleChangeDisplayOption),this.on(s.CHANGE_FILTER_APPEARANCE,this.handleFilterAppearanceChange),this.on(s.CHANGE_PAGE,this.handlePageChange),this.productsService.load().then(this.handleDataLoad).then(this.handleStateLoad).catch((t=>{this.emit(s.SHOW_ALERT,`Ошибка при загрузке данных: ${t.message}`),this.handleAppLoad(t)})),this.getRoot().insertAdjacentHTML("beforeend",this.render()),this.afterRender()}get sort(){const[t,e]=m[this.state.sort];return e}updateProductsList(t=this.filtred){this.emit(s.UPDATE_PRODUCTS_LIST,{products:t,state:this.state})}}({emmiter:new Mt},"#app")})();